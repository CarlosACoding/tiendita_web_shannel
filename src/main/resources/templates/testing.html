










<h1>Inventario de Productos</h1>
<!-- Contenedor de la alerta (inicialmente oculto) -->
<div id="mensaje" class="alert alert-dismissible fade show" role="alert" style="display:none;">
    <span id="mensajeTexto"></span> <!-- Aquí se insertará el mensaje dinámicamente -->
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>



<script>
// Eliminar registro AJAX
        $(document).on('click', '.delete-btn', function (event) {
            event.preventDefault(); // Prevenir la acción predeterminada

            var carroId = $(this).data('id'); // Obtener el ID del carro

            if (confirm('¿Estás seguro de que quieres eliminar este producto?')) {
                $.ajax({
                    url: '/carro/eliminar/' + carroId,  // URL para la eliminación
                    type: 'DELETE',  // Tipo de solicitud HTTP
                    success: function (response, textStatus, jqXHR) {
                        // Verificar si la respuesta tiene el código 200
                        if (jqXHR.status === 200) {

                            // Log de depuración: Ver la respuesta completa del servidor
                            console.log("Respuesta del servidor:", response);

                            // Mostrar el mensaje de éxito
                            $('#mensajeTexto').text(response.mensaje);  // Actualiza el texto del mensaje
                            $('#mensaje').removeClass('alert-danger').addClass('alert-success').show().delay(3000).fadeOut();  // Muestra la alerta de éxito
                            $('button[data-id="' + carroId + '"]').closest('tr').remove();
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        // Si ocurre un error, muestra un mensaje de error
                        $('#mensajeTexto').text('Hubo un problema al eliminar el producto.');
                        $('#mensaje').removeClass('alert-success').addClass('alert-danger').show().delay(5000).fadeOut();  // Muestra la alerta de error
                    }
                });
            }
        });


        window.addEventListener('storage', function (event) {
            // Verificamos si el evento está relacionado con 'productoActualizado'
            if (event.key === 'productoActualizado') {
                var updatedProduct = JSON.parse(event.newValue);

                // Aquí actualizamos el contenido de la tabla con los nuevos datos
                var fila = $('tr').filter(function () {
                    return $(this).find('td').first().text() == updatedProduct.marca;
                });

                fila.find('td').eq(1).text(updatedProduct.color);  // Actualiza la columna de color
                fila.find('td').eq(2).find('img').attr('src', '/img/' + updatedProduct.imagen);  // Actualiza la imagen

                // Puedes mostrar una notificación aquí también si deseas
                alert('Producto actualizado: ' + updatedProduct.marca);
            }
        });

</script>



























